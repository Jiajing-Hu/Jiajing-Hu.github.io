---
title: 代价敏感错误率与代价曲线
date: 2019-05-07 16:29:04
tags: 机器学习
mathjax: true
---

# **代价敏感错误率与代价曲线**

现实生活中，不同类型的错误造成的后果也不会相同。为了权衡不同错误类型所造成的不同的损失，可以为错误赋予**非均等代价**。


以二分任务为例，我们可以根据任务的领域只是设定一个**代价矩阵**。


<table>
    <tr>
        <th rowspan="2">真实情况</th>
        <th colspan="2">预测结果</th>
    </tr>
    <tr>
        <td>第0类</td>
        <td>第一类</td>
    </tr>
    <tr>
        <td>第0类</td>
        <td>0</td>
        <td>cost01</td>
    </tr>
    <tr>
        <td>第1类</td>
        <td>cost10</td>
        <td>0</td>
    </tr>
</table>

其中$cost_{ij}$表示将第$i$类预测为第$j$类的代价。

在非均等代价下，我们不仅仅追求最小化错误次数，而是追求最小化错误总体代价。即：

$$
E(f;D;cost)=\frac{1}{m}\left( \sum_{x\in D^+}\mathbb I(f(x_i)\neq y_i)cost_{01}
\\
+\sum_{x\in D^-}\mathbb{I}(f(x_i)\neq y_i)cost_{10}\right)
$$

同理，多分类任务中也可以使用这种方式最小化总体代价。

在非均等代价下，ROC曲线不能直接反映出学习器的期望总体代价，而**代价曲线**则可以达到目的。

代价曲线的横轴是取值为$[0,1]$的正例概率代价：


$$
P(+)cost=\frac{p\cdot cost_{01}}{p\cdot cost_{01}+(1-p)\cdot cost_{10}}
$$

其中$p$是正例的概率，纵轴是取值为$[0,1]$的归一化代价：
$$
cost_{norm}=\frac{FNR\cdot p\cdot cost{01}+FPR\cdot (1-p)\cdot cost_{10}}{p\cdot cost_{01} + (1-p)\cdot cost_{10}}
$$

其中$FPR$表示假正例率，$FNR=1-TPR$表示假反例率。

代价曲线的绘制方式如下：

设ROC曲线上的点的坐标为$(FPR,TPR)$,则可以计算出相应的$FNR$,然后在平面上绘制一条从$(0,FPR)$到$(1,FNR)$的线段。线段下的面积即表示了该条件下期望总体代价。如此将ROC曲线上的每一个点转换为代价平面上的一条线段，然后取所有线段的下界，围成的面积即为学习器的期望总体代价。
